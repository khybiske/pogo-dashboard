<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pokemon Go Dashboard</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: linear-gradient(135deg, #FF6B6B 0%, #4ECDC4 100%);
  padding: 15px;
  min-height: 100vh;
}
.container {
  max-width: 600px;
  margin: 0 auto;
}
.header {
  background: white;
  border-radius: 15px 15px 0 0;
  padding: 20px;
  text-align: center;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
.header h1 {
  color: #FF6B6B;
  font-size: 24px;
  margin-bottom: 5px;
}
.status-badge {
  display: inline-block;
  padding: 5px 15px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: bold;
  margin-top: 10px;
}
.status-connected { background: #d4edda; color: #155724; }
.status-disconnected { background: #f8d7da; color: #721c24; }
.status-loading { background: #fff3cd; color: #856404; }
.card {
  background: white;
  padding: 20px;
  margin: 0;
  border-top: 1px solid #eee;
}
.card:last-child {
  border-radius: 0 0 15px 15px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
.card h2 {
  color: #333;
  font-size: 18px;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 2px solid #4ECDC4;
}
.test-input {
  width: 100%;
  padding: 12px;
  border: 2px solid #ddd;
  border-radius: 8px;
  font-size: 16px;
  margin: 10px 0;
}
.btn {
  background: #4ECDC4;
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  width: 100%;
  margin-top: 10px;
  font-weight: bold;
}
.btn:active { background: #3db8af; }
.btn:disabled { background: #ccc; cursor: not-allowed; }
.saved-data {
  background: #f8f9fa;
  padding: 15px;
  border-radius: 8px;
  margin-top: 10px;
  min-height: 50px;
}
.info-text {
  font-size: 14px;
  color: #666;
  line-height: 1.6;
  margin: 10px 0;
}
.timestamp {
  font-size: 12px;
  color: #999;
  margin-top: 10px;
}
ol {
  margin: 10px 0 0 20px;
  line-height: 1.8;
}
.loading {
  text-align: center;
  color: #666;
  padding: 20px;
}
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>‚ö° Pokemon Go Dashboard</h1>
    <div class="status-badge status-loading" id="statusBadge">üîÑ Connecting to Google Sheets...</div>
  </div>

  <div class="card">
    <h2>üìã Google Sheets Sync Test</h2>
    <p class="info-text">This test saves data to your Google Sheet and retrieves it on any device.</p>
    
    <input type="text" class="test-input" id="testInput" placeholder="Enter a Pokemon name...">
    <button class="btn" id="saveBtn" onclick="saveToSheet()">üíæ Save to Google Sheets</button>
    
    <div class="saved-data">
      <strong>Data from Google Sheets:</strong>
      <div id="displayData" style="margin-top: 10px;">
        <div class="loading">Loading...</div>
      </div>
      <div class="timestamp" id="timestamp"></div>
    </div>
  </div>

  <div class="card">
    <h2>üîß Next Steps</h2>
    <ol>
      <li>Save test data above</li>
      <li>Check your Google Sheet - you should see the data appear</li>
      <li>Open this page on another device</li>
      <li>Verify the same data loads automatically</li>
      <li>Once confirmed, we'll build the full dashboard!</li>
    </ol>
  </div>

  <div class="card">
    <h2>‚ÑπÔ∏è Connection Info</h2>
    <div class="info-text">
      <strong>Sheet Status:</strong> <span id="sheetStatus">Testing connection...</span><br>
      <strong>Last Sync:</strong> <span id="lastSync">Never</span><br>
      <strong>Device:</strong> <span id="deviceInfo"></span>
    </div>
  </div>
</div>

<script>
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxeEnHA5MtsH2yIzsKOMB4Irz9R1Wqsj6SrcsZjjSEcF2McHJYQxpUhMbcFtXGf80ybIw/exec';
const TEST_SHEET = 'PowerUpPriority';

// Load data from Google Sheets
async function loadFromSheet() {
  try {
    const response = await fetch(`${SCRIPT_URL}?sheet=${TEST_SHEET}`);
    const result = await response.json();
    
    if (result.error) {
      throw new Error(result.error);
    }
    
    if (result.data && result.data.length > 0) {
      // Display the data
      const lastRow = result.data[result.data.length - 1];
      const testData = lastRow[0] || 'No data';
      const timestamp = lastRow[1] || 'Unknown time';
      const device = lastRow[2] || 'Unknown device';
      
      document.getElementById('displayData').innerHTML = `
        <div style="color: #333; font-size: 16px; margin-top: 5px;">${testData}</div>
      `;
      document.getElementById('timestamp').textContent = `Saved: ${timestamp} from ${device}`;
      document.getElementById('testInput').value = testData;
      document.getElementById('lastSync').textContent = new Date().toLocaleTimeString();
    } else {
      document.getElementById('displayData').innerHTML = '<em style="color: #999;">No data in sheet yet</em>';
    }
    
    document.getElementById('sheetStatus').innerHTML = '‚úÖ Connected';
    document.getElementById('statusBadge').textContent = '‚úÖ Google Sheets Connected';
    document.getElementById('statusBadge').className = 'status-badge status-connected';
    
  } catch (error) {
    console.error('Load error:', error);
    document.getElementById('sheetStatus').innerHTML = '‚ùå Connection failed';
    document.getElementById('statusBadge').textContent = '‚ùå Connection Error';
    document.getElementById('statusBadge').className = 'status-badge status-disconnected';
    document.getElementById('displayData').innerHTML = `<em style="color: #dc3545;">Error: ${error.message}</em>`;
  }
}

// Save data to Google Sheets
async function saveToSheet() {
  const input = document.getElementById('testInput').value;
  if (!input) {
    alert('Please enter some text first!');
    return;
  }
  
  const saveBtn = document.getElementById('saveBtn');
  saveBtn.disabled = true;
  saveBtn.textContent = 'üíæ Saving...';
  
  try {
    const timestamp = new Date().toLocaleString();
    const device = /iPhone|iPad|iPod/.test(navigator.userAgent) ? 'iPhone/iPad' : 'Desktop';
    
    const response = await fetch(SCRIPT_URL, {
      method: 'POST',
      body: JSON.stringify({
        sheet: TEST_SHEET,
        values: [
          ['Pokemon', 'Timestamp', 'Device'],
          [input, timestamp, device]
        ]
      })
    });
    
    const result = await response.json();
    
    if (result.error) {
      throw new Error(result.error);
    }
    
    document.getElementById('statusBadge').textContent = '‚úÖ Saved Successfully!';
    document.getElementById('statusBadge').className = 'status-badge status-connected';
    
    // Reload data
    setTimeout(() => loadFromSheet(), 500);
    
  } catch (error) {
    console.error('Save error:', error);
    alert('‚ùå Save failed: ' + error.message);
    document.getElementById('statusBadge').textContent = '‚ùå Save Error';
    document.getElementById('statusBadge').className = 'status-badge status-disconnected';
  } finally {
    saveBtn.disabled = false;
    saveBtn.textContent = 'üíæ Save to Google Sheets';
  }
}

// Get device info
function getDeviceInfo() {
  const ua = navigator.userAgent;
  if (/iPhone/.test(ua)) return 'iPhone (Safari)';
  if (/iPad/.test(ua)) return 'iPad (Safari)';
  if (/Mac/.test(ua)) return 'Mac (Safari)';
  return 'Browser: ' + (ua.match(/Chrome|Safari|Firefox/) || ['Unknown'])[0];
}

// Initialize
window.onload = function() {
  document.getElementById('deviceInfo').textContent = getDeviceInfo();
  loadFromSheet();
};
</script>

</body>
</html>
