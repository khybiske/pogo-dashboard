<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MachoMankey's PoGo Dashboard</title>

<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: #f2f2f7;
  padding: 8px;
  min-height: 100vh;
  color: #1c1c1e;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding-bottom: 40px;
}

/* HEADER */
.header {
  background: #3B7DDD;
  border-radius: 18px;
  padding: 20px 15px;
  text-align: center;
  box-shadow: 0 6px 20px rgba(59,125,221,0.35);
  margin-bottom: 18px;
}

.header h1 {
  color: white;
  font-size: 22px;
  font-weight: 800;
}

.trainer-info {
  color: rgba(255,255,255,0.9);
  font-size: 14px;
  margin-top: 6px;
}

.trainer-level {
  color: #FFD700;
  font-weight: 700;
}

.status-badge {
  display: inline-block;
  padding: 6px 14px;
  border-radius: 14px;
  font-size: 11px;
  font-weight: 700;
  margin-top: 8px;
}

.status-connected { background: #34C759; color: white; }
.status-disconnected { background: #FF3B30; color: white; }
.status-loading { background: #FFCC00; color: #1c1c1e; }

/* SECTIONS */
.section {
  background: white;
  border-radius: 14px;
  margin-bottom: 14px;
  box-shadow: 0 4px 14px rgba(0,0,0,0.08);
  overflow: hidden;
  transition: transform 0.15s ease;
}

.section:hover { transform: translateY(-2px); }

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 14px 16px;
  background: #3B7DDD;
  cursor: pointer;
}

.section-header h2 {
  color: white;
  font-size: 15px;
  font-weight: 700;
}

.collapse-icon {
  color: white;
  font-size: 18px;
  transition: transform 0.2s ease;
}

.section-header.collapsed .collapse-icon {
  transform: rotate(-90deg);
}

.section-content {
  padding: 16px;
}

.section-content.collapsed { display: none; }

/* EVENTS */
.event-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px;
  margin: 6px 0;
  background: #f5f7fb;
  border-radius: 10px;
  font-size: 13px;
}

.event-item-live {
  background: #fff3cd;
  border-left: 4px solid #FF9500;
}

.event-item-text strong { color: #3B7DDD; }

/* GENERIC LIST ITEMS */
.list-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px;
  margin-bottom: 8px;
  background: #f5f7fb;
  border-radius: 10px;
  font-size: 13px;
}

.list-item img {
  width: 40px;
  height: 40px;
}

.badge {
  display: inline-block;
  padding: 3px 8px;
  border-radius: 8px;
  font-size: 11px;
  font-weight: 700;
}

.badge-priority-high { background: #ff3b30; color: white; }
.badge-priority-medium { background: #ffcc00; color: black; }
.badge-priority-low { background: #34c759; color: white; }

/* BUTTONS */
.btn {
  background: #3B7DDD;
  color: white;
  border: none;
  padding: 8px 14px;
  border-radius: 8px;
  font-size: 13px;
  cursor: pointer;
  font-weight: 600;
}

.btn-small {
  padding: 6px 10px;
  font-size: 12px;
}

.loading, .empty-state {
  text-align: center;
  padding: 20px;
  color: #8e8e93;
  font-size: 13px;
}
</style>
</head>

<body>
<div class="container">

<div class="header">
  <h1>‚ö° POK√âMON GO DASHBOARD</h1>
  <div class="trainer-info">
    MachoMankey ‚Ä¢ Level <span class="trainer-level">71</span>
  </div>
  <div class="status-badge status-loading" id="syncStatus">üîÑ Syncing...</div>
</div>

<!-- CURRENT EVENTS -->
<div class="section">
  <div class="section-header" onclick="toggleSection(this)">
    <h2>üìÖ Current Events</h2>
    <span class="collapse-icon">‚ñº</span>
  </div>
  <div class="section-content">
    <div id="eventsList" class="loading">Loading events...</div>
  </div>
</div>

<!-- POWER UP PRIORITY -->
<div class="section">
  <div class="section-header" onclick="toggleSection(this)">
    <h2>‚ö° Power-Up Priority</h2>
    <span class="collapse-icon">‚ñº</span>
  </div>
  <div class="section-content">
    <div id="powerUpContent" class="loading">Loading...</div>
  </div>
</div>

<!-- RARE CANDY -->
<div class="section">
  <div class="section-header" onclick="toggleSection(this)">
    <h2>üç¨ Rare Candy Priority</h2>
    <span class="collapse-icon">‚ñº</span>
  </div>
  <div class="section-content">
    <div id="rareCandyContent" class="loading">Loading...</div>
  </div>
</div>

<!-- LUCKY TRADES -->
<div class="section">
  <div class="section-header" onclick="toggleSection(this)">
    <h2>ü§ù Lucky Trades</h2>
    <span class="collapse-icon">‚ñº</span>
  </div>
  <div class="section-content">
    <div id="tradePlansContent" class="loading">Loading...</div>
  </div>
</div>

<!-- SHINY GAPS -->
<div class="section">
  <div class="section-header" onclick="toggleSection(this)">
    <h2>‚ú® Community Day Shiny Gaps</h2>
    <span class="collapse-icon">‚ñº</span>
  </div>
  <div class="section-content">
    <div id="shinyGapsContent" class="loading">Loading...</div>
  </div>
</div>

</div>

<script>
const SCRIPT_URL = 'YOUR_SCRIPT_URL';

let powerUpData = [];
let candyData = [];
let tradePlansData = [];
let shinyGapsData = [];
let eventsData = [];

function toggleSection(header) {
  header.classList.toggle('collapsed');
  header.nextElementSibling.classList.toggle('collapsed');
}

async function loadSheetData(sheetName) {
  const response = await fetch(`${SCRIPT_URL}?sheet=${sheetName}`);
  const result = await response.json();
  return result.data || [];
}

async function saveSheetData(sheetName, data) {
  const response = await fetch(SCRIPT_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ sheet: sheetName, values: data })
  });
  return await response.json();
}

async function loadAllData() {
  document.getElementById('syncStatus').textContent = 'üîÑ Syncing...';
  document.getElementById('syncStatus').className = 'status-badge status-loading';

  try {
    const [powerUp, candy, trades, shinyGaps, events] = await Promise.all([
      loadSheetData('PowerUpPriority'),
      loadSheetData('RareCandyPriority'),
      loadSheetData('LuckyTradePlans'),
      loadSheetData('CommunityDayShinies'),
      loadSheetData('CurrentEvents')
    ]);

    powerUpData = powerUp.slice(1);
    candyData = candy.slice(1);
    tradePlansData = trades.slice(1);
    shinyGapsData = shinyGaps.slice(1);
    eventsData = events.slice(1);

    renderEvents();
    renderPowerUp();

    document.getElementById('syncStatus').textContent = '‚úÖ Synced';
    document.getElementById('syncStatus').className = 'status-badge status-connected';
  } catch (err) {
    document.getElementById('syncStatus').textContent = '‚ùå Sync Error';
    document.getElementById('syncStatus').className = 'status-badge status-disconnected';
  }
}

function renderEvents() {
  const container = document.getElementById('eventsList');
  const today = new Date().toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();

  if (!eventsData.length) {
    container.innerHTML = '<div class="empty-state">No events loaded.</div>';
    return;
  }

  let html = '';
  eventsData.forEach(row => {
    const [icon, type, desc] = row;
    const isLive = desc.toLowerCase().includes('today') || desc.toLowerCase().includes(today);

    html += `
      <div class="event-item ${isLive ? 'event-item-live' : ''}">
        <div>${icon}</div>
        <div><strong>${type}:</strong> ${desc}</div>
      </div>
    `;
  });

  container.innerHTML = html;
}

function renderPowerUp() {
  const container = document.getElementById('powerUpContent');
  if (!powerUpData.length) {
    container.innerHTML = '<div class="empty-state">No entries.</div>';
    return;
  }

  const priorityOrder = { High: 1, Medium: 2, Low: 3 };

  const sorted = [...powerUpData].sort((a, b) => {
    const pa = priorityOrder[a[12]] ?? 99;
    const pb = priorityOrder[b[12]] ?? 99;
    return pa - pb;
  });

  let html = '';
  sorted.forEach(row => {
    const [pokemon, , , , , current, target, role, , , , notes, priority] = row;
    const priorityClass = priority ? priority.toLowerCase() : 'low';

    html += `
      <div class="list-item">
        <div><strong>${pokemon}</strong></div>
        <div>Lv ${current} ‚Üí ${target}</div>
        <div>${role}</div>
        <span class="badge badge-priority-${priorityClass}">${priority}</span>
        ${notes ? `<div>${notes}</div>` : ''}
      </div>
    `;
  });

  container.innerHTML = html;
}

window.onload = loadAllData;
</script>

</body>
</html>
